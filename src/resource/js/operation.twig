{% include 'params.twig' with {'operationId': operation.operationId, 'parameters': operation.parameters} %}

export function {{ operation.operationId }}(params: {{ operation.operationId }}Params, options:? FetchOptions): Promise<{{ operation.return }}> {
{% spaceless %}
{% set hasPathParameters = false %}
{% set hasFileParameter = false %}
{% set pathParameterName = "" %}

{% for parameter in operation.parameters %}
    {% if parameter.in == "path" %}
        {% set hasPathParameters = true %}
    {% endif %}
    {% if parameter.type == "file" %}
        {% set hasFileParameter = true %}
    {% endif %}
{% endfor %}
{% endspaceless %}
{% if hasPathParameters %}
{% for parameter in operation.parameters %}
{% if parameter.in == "path" %}
{% set pathParameterName = parameter.name %}
    if (params["{{ parameter.name }}"] == null) {
        throw new Error("Missing required parameter {{ parameter.name }} when calling {{ operation.operationId }}");
    }
{% endif %}
{% endfor %}

    const baseUrl = `{{ operation.path }}`.replace(`{${"{{ pathParameterName }}"}}`, `${params.{{ pathParameterName }}}`);
    delete params.{{ pathParameterName }};
{% else %}
    const baseUrl = "{{ operation.path }}";
{% endif %}

{% if hasFileParameter %}
    return formDataRequest(baseUrl, params, "{{ operation.method|upper }}", options);
{% else %}
    return request(baseUrl, params, "{{ operation.method|upper }}", options);
{% endif %}
}
